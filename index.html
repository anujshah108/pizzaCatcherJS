<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>tracking.js - first tracking</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="./build/tracking-min.js"></script>
  <script src="./build/data/mouth.js"></script>
</head>
<body>
  <div id="site">
  <video id="myVideo" autoplay="true" width="300px" height='400px' preload autoplay loop muted></video>
    <div id="snowZone"></div>
</div>
  <script>

  var video = document.querySelector("#myVideo");

  navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia;

  if (navigator.getUserMedia) {
     navigator.getUserMedia({video: true}, handleVideo, videoError);
  }

  function handleVideo(stream) {
     video.src = window.URL.createObjectURL(stream);
  }

  function videoError(e) {
     console.log(e)
  }

  window.onload = function() {
        const tracker = new tracking.ObjectTracker(['mouth']);
        tracker.setInitialScale(0.8);
        tracker.setStepSize(1.5);
        tracker.setEdgesDensity(0.1);
        tracking.track('#myVideo', tracker, { camera: true });
        tracker.on('track', function(event) {
          event.data.forEach(function(rect) {
            console.log('IN YA MOUTH', rect.x, rect.y, rect.width, rect.height)
          });
        });
      };

 function fallingSnow() {

        var $snowflakes = $(), qt = 20;

        for (var i = 0; i < qt; ++i) {
            var $snowflake = $('<img class="snowflakes" src ="pizza.png">');
            $snowflake.css({
                'left': (Math.random() * $('#site').width()) + 'px',
                'top': (- Math.random() * $('#site').height()) + 'px'
            });
            // add this snowflake to the set of snowflakes
            $snowflakes = $snowflakes.add($snowflake);
        }
        $('#snowZone').prepend($snowflakes);

        $snowflakes.animate({
            top: "1000px"
        }, Math.random() + 10000, function(){
            $(this).remove();
            // run again when all 20 snowflakes hit the floor
            if (--qt < 1) {
                fallingSnow();
            }
        });
    }

    fallingSnow();

//   const mouth = new tracking.ObjectTracker(['mouth']);

//   mouth.on('track', function(event) {
//     if (event.data.length === 0) {
//       // No colors were detected in this frame.
//     } else {
//       event.data.forEach(function(rect) {
//         console.log('MOUTH SPOTTED AT:', rect.x, rect.y, rect.height, rect.width);
//       });
//     }
//   });

//   tracking.track('#myVideo', mouth);

// $('#pizza')

  </script>


</body>
</html>
